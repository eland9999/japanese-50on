<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>日英雙語互動學習</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --jp-main: #ed2939;
      --accent: #1f2937;
      --bg: #f7f8fa;
      --card: #fff;
      --gap: 16px;
    }
    * { box-sizing: border-box; }
    body { margin: 0; padding: 0; font-family: 'Noto Sans JP','Roboto', sans-serif; background: var(--bg); }
    header { text-align: center; padding: 24px 0; }
    header h1 { margin: 0; font-size: 2.1em; color: var(--accent); }
    #langSwitch, .controls { text-align: center; margin-bottom: 20px; }
    #langSwitch button, .controls button {
      margin: 0 6px; padding: 8px 16px; border: none; border-radius: 8px;
      background: var(--accent); color: #fff; font-weight: 700; cursor: pointer;
      transition: background .2s;
    }
    #langSwitch button.active, .controls button.active { background: var(--jp-main); }
    .card { background: var(--card); border-radius: 20px; box-shadow: 0 6px 24px rgba(50,60,100,.09);
      max-width: 980px; margin: 0 auto 32px; padding: 32px 24px; }
    .quiz-title { font-size: 1.2em; font-weight: 700; color: #fff;
      background: var(--jp-main); padding: 8px 0; border-radius: 8px;
      text-align: center; margin-bottom: var(--gap); }
    .jp-grid { display: grid; grid-template-columns: repeat(10,1fr); gap: var(--gap); }
    .question { background: #fafdff; border: 1px solid #e2e4e8; border-radius: 12px;
      padding: 12px 6px; display: flex; flex-direction: column; align-items: center;
      height: 96px; }
    .question label { font-size: 1.2em; color: var(--jp-main); font-weight: 700; margin-bottom: 8px; }
    .question input { width: 80%; padding: 4px; font-size: 1em; border: 1px solid #dadada;
      border-radius: 4px; background: #f6f8fa; text-align: center; }
    .feedback { margin-top: 6px; font-weight: 700; font-size: 0.95em; }
    .correct { color: #21ab39; }
    .incorrect { color: #e54e52; }

    /* 五十音表橫向方格 */
    .jp-50on-table-wrap { overflow-x: auto; text-align:center; }
    .jp-50on-table { border-collapse: collapse; background: #fff; margin: 0 auto;}
    .jp-50on-table th {
      color: var(--jp-main); font-weight: bold; font-size: 1.1em; padding: 6px 14px 8px 14px; border-bottom: 2px solid #efefef;
      text-align: center;
    }
    .jp-50on-table td {
      padding: 6px 14px;
      font-size: 1.14em;
      border-bottom: 1px solid #f5f5f5;
      text-align: center;
      min-width: 46px;
      height: 34px;
      vertical-align: middle;
    }
    .jp-50on-table td.kana { font-weight: bold; color: #111; font-size: 1.15em; }
    .jp-50on-table td.roman { color: #666; font-size: 0.98em; }
    .jp-50on-table tr { border-bottom: 1px solid #eee; }
    .jp-50on-table tr:last-child td { border-bottom: none; }
  </style>
</head>
<body>
  <header><h1>日英雙語互動學習</h1></header>
  <div id="langSwitch">
    <button id="btnJP" class="active">日文50音</button>
  </div>
  <section id="jpSection" class="active">
    <div class="controls" id="jpControls">
      <button id="btnBasic" data-mode="basic" class="active">基本50音</button>
      <button id="btnDakuten" data-mode="dakuten">濁音</button>
      <button id="btnHandakuten" data-mode="handakuten">半濁音</button>
      <button id="btnReviewBasic" data-mode="review-basic">基本複習</button>
      <button id="btnReviewDakuten" data-mode="review-dakuten">濁音複習</button>
      <button id="btnReviewHandakuten" data-mode="review-handakuten">半濁音複習</button>
    </div>
    <div class="card" id="jpQuiz"></div>
  </section>
  <script>
    // 五十音資料
    const dataMap = {
      basic: [
        {kana:'あ',answer:'a'},{kana:'い',answer:'i'},{kana:'う',answer:'u'},{kana:'え',answer:'e'},{kana:'お',answer:'o'},
        {kana:'か',answer:'ka'},{kana:'き',answer:'ki'},{kana:'く',answer:'ku'},{kana:'け',answer:'ke'},{kana:'こ',answer:'ko'},
        {kana:'さ',answer:'sa'},{kana:'し',answer:'shi'},{kana:'す',answer:'su'},{kana:'せ',answer:'se'},{kana:'そ',answer:'so'},
        {kana:'た',answer:'ta'},{kana:'ち',answer:'chi'},{kana:'つ',answer:'tsu'},{kana:'て',answer:'te'},{kana:'と',answer:'to'},
        {kana:'な',answer:'na'},{kana:'に',answer:'ni'},{kana:'ぬ',answer:'nu'},{kana:'ね',answer:'ne'},{kana:'の',answer:'no'},
        {kana:'は',answer:'ha'},{kana:'ひ',answer:'hi'},{kana:'ふ',answer:'fu'},{kana:'へ',answer:'he'},{kana:'ほ',answer:'ho'},
        {kana:'ま',answer:'ma'},{kana:'み',answer:'mi'},{kana:'む',answer:'mu'},{kana:'め',answer:'me'},{kana:'も',answer:'mo'},
        {kana:'や',answer:'ya'},{kana:'ゆ',answer:'yu'},{kana:'よ',answer:'yo'},{kana:'ら',answer:'ra'},{kana:'り',answer:'ri'},
        {kana:'る',answer:'ru'},{kana:'れ',answer:'re'},{kana:'ろ',answer:'ro'},{kana:'わ',answer:'wa'},{kana:'を',answer:'wo'},{kana:'ん',answer:'n'}
      ],
      dakuten: [
        {kana:'が',answer:'ga'},{kana:'ぎ',answer:'gi'},{kana:'ぐ',answer:'gu'},{kana:'げ',answer:'ge'},{kana:'ご',answer:'go'},
        {kana:'ざ',answer:'za'},{kana:'じ',answer:'ji'},{kana:'ず',answer:'zu'},{kana:'ぜ',answer:'ze'},{kana:'ぞ',answer:'zo'},
        {kana:'だ',answer:'da'},{kana:'ぢ',answer:'ji'},{kana:'づ',answer:'zu'},{kana:'で',answer:'de'},{kana:'ど',answer:'do'},
        {kana:'ば',answer:'ba'},{kana:'び',answer:'bi'},{kana:'ぶ',answer:'bu'},{kana:'べ',answer:'be'},{kana:'ぼ',answer:'bo'}
      ],
      handakuten: [
        {kana:'ぱ',answer:'pa'},{kana:'ぴ',answer:'pi'},{kana:'ぷ',answer:'pu'},{kana:'ぺ',answer:'pe'},{kana:'ぽ',answer:'po'}
      ]
    };

    const jpQuiz = document.getElementById('jpQuiz');
    const jpControls = document.getElementById('jpControls');

    function shuffle(arr) { return arr.slice().sort(() => Math.random() - 0.5); }

    function renderQuiz(mode) {
      [...jpControls.children].forEach(btn => btn.classList.toggle('active', btn.dataset.mode === mode));
      const isReview = mode.startsWith('review');
      const key = mode.replace('review-','');
      const items = dataMap[key];
      jpQuiz.innerHTML = `<div class="quiz-title">${btnText(mode)}</div>`;
      if (isReview) {
        if (mode === 'review-basic') {
          render50onTable(items);
        } else if (mode === 'review-dakuten') {
          renderGroupTable(items, [
            ['が','ぎ','ぐ','げ','ご'],
            ['ざ','じ','ず','ぜ','ぞ'],
            ['だ','ぢ','づ','で','ど'],
            ['ば','び','ぶ','べ','ぼ']
          ]);
        } else if (mode === 'review-handakuten') {
          renderGroupTable(items, [
            ['ぱ','ぴ','ぷ','ぺ','ぽ']
          ]);
        }
      } else {
        const grid = document.createElement('div'); grid.className = 'jp-grid';
        shuffle(items).forEach((it,i) => {
          const q = document.createElement('div'); q.className='question';
          q.innerHTML = `<label>${i+1}. ${it.kana}</label><input data-answer="${it.answer}" /><span class="feedback"></span>`;
          grid.appendChild(q);
        });
        jpQuiz.appendChild(grid);
        grid.addEventListener('keydown', e => {
          if (e.key==='Enter' && e.target.tagName==='INPUT') {
            const fb = e.target.nextElementSibling;
            fb.textContent = e.target.value.trim().toLowerCase()===e.target.dataset.answer? '✔': `✘ ${e.target.dataset.answer}`;
            fb.className='feedback '+(fb.textContent==='✔'?'correct':'incorrect');
          }
        });
      }
    }

    // 基本50音表 - 音行方正橫式
    function render50onTable(items) {
      // 五十音圖分10橫行，缺字空格
      const matrix = [
        ['あ','い','う','え','お'],
        ['か','き','く','け','こ'],
        ['さ','し','す','せ','そ'],
        ['た','ち','つ','て','と'],
        ['な','に','ぬ','ね','の'],
        ['は','ひ','ふ','へ','ほ'],
        ['ま','み','む','め','も'],
        ['や','','ゆ','','よ'],
        ['ら','り','る','れ','ろ'],
        ['わ','','を','','ん']
      ];
      let table = '<div class="jp-50on-table-wrap"><table class="jp-50on-table">';
      // 表頭
      table += '<tr>';
      for (let i=0;i<5;i++) table += '<th>假名</th><th>羅馬音</th>';
      table += '</tr>';
      // 內容
      for (let row of matrix) {
        table += '<tr>';
        for (let kana of row) {
          if (kana) {
            const obj = items.find(it => it.kana === kana);
            table += `<td class="kana">${obj.kana}</td><td class="roman">${obj.answer}</td>`;
          } else {
            table += '<td></td><td></td>';
          }
        }
        table += '</tr>';
      }
      table += '</table></div>';
      jpQuiz.innerHTML += table;
    }

    // 濁音、半濁音 - 方正分組橫排
    function renderGroupTable(items, groups) {
      let table = '<div class="jp-50on-table-wrap"><table class="jp-50on-table">';
      table += '<tr>';
      for (let i=0;i<groups[0].length;i++) table += '<th>假名</th><th>羅馬音</th>';
      table += '</tr>';
      for (let row=0;row<groups.length;row++) {
        table += '<tr>';
        for (let col=0;col<groups[row].length;col++) {
          const kana = groups[row][col];
          if (kana) {
            const obj = items.find(it => it.kana === kana);
            table += `<td class="kana">${obj.kana}</td><td class="roman">${obj.answer}</td>`;
          } else {
            table += '<td></td><td></td>';
          }
        }
        table += '</tr>';
      }
      table += '</table></div>';
      jpQuiz.innerHTML += table;
    }

    function btnText(mode) {
      const map = {
        basic: '基本50音測驗', dakuten: '濁音測驗', handakuten: '半濁音測驗',
        'review-basic': '基本50音複習', 'review-dakuten':'濁音複習', 'review-handakuten':'半濁音複習'
      };
      return map[mode] || '';
    }

    document.getElementById('btnJP').onclick = () => {
      document.getElementById('jpSection').classList.add('active');
      document.getElementById('btnJP').classList.add('active');
    };
    jpControls.addEventListener('click', e => {
      if (e.target.tagName==='BUTTON') renderQuiz(e.target.dataset.mode);
    });
    window.onload = () => renderQuiz('basic');
  </script>
</body>
</html>
